<!--TeXを使う際のおまじない
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax:{inlineMath:[['\$','\$'],['\\(','\\)']],processEscapes:true},CommonHTML: {matchFontHeight:false}});</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
-->

# 詰み部品の消化がてらRasPicoを触る

<h2><div align="right">2022/10/13</div></h2>

<!-- 記事ここから -->

Raspberry Pi Pico（通称RasPico）を発売日に買ったはいいが全然使ってないということに気づいてしまったので消化します

<div align="center"><img src="https://user-images.githubusercontent.com/91242561/195613818-6c5da201-7fd3-4d4c-ae9c-3258e1c3491d.png" alt="" width="75%" border="4"></div>

ここに写ってるのは3個ですが、実際はもうちょいあります。全部で5個かな

して、このうち一つを~~徴用~~活用してRasPico遊びをしていきましょう

<div align="center">
  <img src="https://user-images.githubusercontent.com/91242561/195616042-ad827084-94fe-4e1a-9efa-aabd3503cbca.png" alt="" width="75%" border="4">
  <img src="https://user-images.githubusercontent.com/91242561/195617052-f055cd1b-2bf8-4194-be26-49b7ba85e761.png" alt="" width="75%" border="4">
</div>


マルツに行ったら専用基板があったので使ってみました。いい感じ  
外部の電源を使えるようにレギュレータをつけましたが、今のところ使ってません

で、マイコン触るとなるとGPIO使うことが多いですが、今回はADCを使うことにします。デジタルはまた今度

そのために可変抵抗を追加しま...

<div align="center"><img src="https://user-images.githubusercontent.com/91242561/195617887-a0335b33-3f73-48a6-8c56-8898ab519072.png" alt="" width="75%" border="4"></div>

した。言わずもがな赤色の線が3.3V、黒色がGND、青色が分圧出力です

早速ADCを読んでシリアル出力するプログラムを走らせてみましょう

```cpp
#define ADC0 26
#define ADC1 27

void setup() {
  Serial.begin(115200);
}

void loop() {
  uint16_t ADC_0 = analogRead(ADC0);
  uint16_t ADC_1 = analogRead(ADC1);

  char buff[32];
  sprintf(buff, "%4d, %5d", ADC_0, ADC_1);
  Serial.println(buff);

  delay(125);
}
```

結果：

<div align="center"><img src="https://user-images.githubusercontent.com/91242561/195618724-b71e106d-f8e4-463a-96d8-aa9a0f05cb82.png" alt="" width="50%" border="4"></div>

ちゃんと読めてますね

RP2040のADCは12bitですが互換性のためか10bitになってました。そもそもそこまで精度ないと思うのでまあ良いでしょう

<div align="center"><img src="https://user-images.githubusercontent.com/91242561/195619338-1ba8d91a-0caf-4acc-908a-3b20fb0e0b9c.png" alt="" width="50%" border="4"></div>

シリアルプロッタを開いて可変抵抗を動かさずにちょっと放置  
ちょっとちらついてるので実使用では2bitか3bit分くらい落とした方がいいかも？　あとは（やり方は知らないけど）ADCの積算回数を弄ってみるか

お次は電圧計モード  
とは言ってもVcc電圧を掛けて最大値で割るだけですが

<div align="center">
  <img src="https://user-images.githubusercontent.com/91242561/195619852-c59f1e0c-f2e2-41b7-abcd-191350633053.png" alt="" width="50%" border="4">
  <img src="https://user-images.githubusercontent.com/91242561/195620259-893fa515-11a1-4833-8484-4946356882d9.png" alt="" width="75%" border="4">
  <img src="https://user-images.githubusercontent.com/91242561/195620339-9c4600bc-a15d-47a2-b8bc-e776d59c1e4f.png" alt="" width="75%" border="4">
</div>

一応それなりに近い値は出てました。簡易的に電圧見る分には使えそう

Arduino IDEで開発する場合、`analogRead(pin)`にGPIOの番号を入れて実行するだけでADC読めるのでArduinoと同じ感覚で使えそうですね  
今後この子にはインバータの制御をしてもらおうかと考えてるので進捗があり次第また何か書くかも

<!-- 記事ここまで -->

<footer><div align="right">©Nch_MOSFET</div></footer>

<!-- 画像を入れる時は
<img src="パス" alt="" width="75%" border="4">
<img src="./../img/" alt="" width="75%" border="4">
-->

<!-- Twitterのツイートを埋め込むときは公式の埋め込みリンクをそのまま貼るだけで良い -->
